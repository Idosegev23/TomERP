# הגדרת משתמש סופר אדמין

## סיכום השינויים שבוצעו

✅ **הוספת תפקיד `super_admin` למערכת**
- נוסף לטיפוס `user_role` במסד הנתונים
- עודכנו כל קבצי הטיפוסים ב-frontend
- עודכן ה-AuthContext לתמיכה בתפקיד החדש

✅ **הגדרת trigger אוטומטי**
- כל משתמש שנרשם עם האימייל `triroars@gmail.com` יקבל אוטומטית הרשאות סופר אדמין
- הפונקציה `handle_new_user()` מטפלת ביצירת פרופיל אוטומטי

✅ **עדכון הרשאות**
- סופר אדמין מקבל גישה מלאה לכל המערכת
- פונקציות עזר: `is_super_admin()` ו-`is_admin_or_super()`

## איך ליצור את המשתמש הסופר אדמין

### שלב 1: הרשמה דרך האפליקציה
1. פתח את האפליקציה בדפדפן
2. לך לדף ההרשמה (Sign Up)
3. הירשם עם הפרטים הבאים:
   - **אימייל**: `triroars@gmail.com`
   - **סיסמה**: בחר סיסמה חזקה
   - **שם מלא**: "מנהל מערכת עליון"

### שלב 2: אימות אוטומטי
- המערכת תזהה אוטומטי את האימייל המיוחד
- התפקיד יוגדר אוטומטית ל-`super_admin`
- לא נדרש שום פעולה נוספת

### שלב 3: התחברות
- השתמש בפרטי ההתחברות שיצרת
- תקבל גישה מלאה לכל המערכת

## הרשאות סופר אדמין

המשתמש הסופר אדמין מקבל:
- ✅ גישה מלאה לכל הפרויקטים
- ✅ ניהול יזמים ומשתמשים
- ✅ גישה לכל הבניינים, קומות ודירות
- ✅ ניהול משימות ברמת המערכת
- ✅ גישה לכל הקבצים והמסמכים
- ✅ הרשאות ניהול מלאות

## בדיקת הגדרות

לאחר ההתחברות, ודא שהמשתמש מוגדר נכון:

```sql
-- בדיקה במסד הנתונים
SELECT id, email, full_name, role, is_active 
FROM public.users 
WHERE email = 'triroars@gmail.com';
```

התוצאה הצפויה:
- `role`: `super_admin`
- `is_active`: `true`
- `full_name`: "מנהל מערכת עליון"

## הערות חשובות

1. **אבטחה**: שמור על פרטי ההתחברות במקום בטוח
2. **גיבוי**: תמיד צור גיבוי לפני שינויים במערכת
3. **ניטור**: עקוב אחר פעילות המשתמש הסופר אדמין
4. **הרשאות**: השתמש בהרשאות הסופר אדמין באחריות

## פתרון בעיות

### אם ההרשמה לא עובדת:
1. בדוק שהטריגר פעיל במסד הנתונים
2. ודא שהפונקציה `handle_new_user()` קיימת
3. בדוק לוגים של Supabase לשגיאות

### אם התפקיד לא מוגדר נכון:
```sql
-- עדכון ידני של התפקיד
UPDATE public.users 
SET role = 'super_admin', 
    full_name = 'מנהל מערכת עליון'
WHERE email = 'triroars@gmail.com';
```

---

**המערכת מוכנה לשימוש! 🚀** 